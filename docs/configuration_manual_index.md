# NP21WSY 設定マニュアル総合索引

## 1. マニュアル一覧

本索引では、NP21WSY PC-9801エミュレータの設定に関する全マニュアルの概要と設定項目を整理しています。

### 1.1 設定マニュアルの構成

| マニュアル名 | ファイル名 | 主な対象 |
|--------------|------------|----------|
| ハードウェア設定マニュアル | `hardware_configuration_manual.md` | PCモデル、DIPスイッチ、基本システム |
| CPU・メモリ設定マニュアル | `cpu_memory_configuration_manual.md` | CPU設定、メモリ管理、パフォーマンス |
| サウンド設定マニュアル | `sound_configuration_manual.md` | 音源ボード、MIDI、音量調整 |
| グラフィック設定マニュアル | `graphics_configuration_manual.md` | 表示設定、色設定、描画方式 |
| ストレージ設定マニュアル | `storage_configuration_manual.md` | FDD、HDD、CD-ROM設定 |
| トラブルシューティングガイド | `troubleshooting_guide.md` | 問題解決、診断、対処法 |

---

## 2. 設定項目別索引

### 2.1 基本システム設定

#### PCモデル・機種設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `pc_model` | PC-9801機種選択 | `VX` | ハードウェア設定 |
| `DIPswtch` | DIPスイッチ設定 | `3e 73 7b` | ハードウェア設定 |
| `MEMswtch` | メモリスイッチ設定 | `48 05 04 00 01 00 00 6e` | ハードウェア設定 |

#### CPU・メモリ設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `clk_base` | 基本クロック周波数 | `2457600` | CPU・メモリ設定 |
| `clk_mult` | クロック倍率 | `4` | CPU・メモリ設定 |
| `ExMemory` | 拡張メモリサイズ | `13` | CPU・メモリ設定 |
| `fpu_type` | 浮動小数点演算器 | `1` | CPU・メモリ設定 |

### 2.2 表示・グラフィック設定

#### 基本表示設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `DispSync` | 表示同期方式 | `1` | グラフィック設定 |
| `GRCG_EGC` | グラフィック機能 | `2` | グラフィック設定 |
| `color16b` | 16色モード | `1` | グラフィック設定 |
| `realpal` | 実機相当パレット | `1` | グラフィック設定 |

#### 色・表示品質設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `BG_COLOR` | 背景色 | `000000` | グラフィック設定 |
| `FG_COLOR` | 文字色 | `ffffff` | グラフィック設定 |
| `LCD_MODE` | LCD風表示 | `0` | グラフィック設定 |
| `skipline` | ライン飛ばし | `0` | グラフィック設定 |

### 2.3 サウンド設定

#### 音源ボード設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `SNDboard` | サウンドボード | `04` | サウンド設定 |
| `SampleHz` | サンプリングレート | `44100` | サウンド設定 |
| `Latencys` | オーディオレイテンシ | `150` | サウンド設定 |

#### 音量設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `volume_M` | マスター音量 | `100` | サウンド設定 |
| `volume_F` | FM音源音量 | `64` | サウンド設定 |
| `volume_S` | PSG音量 | `64` | サウンド設定 |
| `volume_A` | ADPCM音量 | `64` | サウンド設定 |
| `volume_P` | PCM音量 | `64` | サウンド設定 |
| `BEEP_vol` | BEEP音量 | `3` | サウンド設定 |

### 2.4 ストレージ設定

#### フロッピーディスク設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `fddequip` | FDD装備設定 | `3` | ストレージ設定 |
| `usefd144` | 1.44MB対応 | `1` | ストレージ設定 |
| `FDD1FILE` | FDD1イメージファイル | （空） | ストレージ設定 |
| `savefddfile` | 自動保存 | `1` | ストレージ設定 |

#### ハードディスク設定
| 設定項目 | 説明 | 推奨値 | 参照マニュアル |
|----------|------|--------|---------------|
| `HDD1FILE` | HDD1イメージファイル | （空） | ストレージ設定 |
| `hdrvenable` | ホストドライブ | `0` | ストレージ設定 |

---

## 3. 用途別設定ガイド

### 3.1 初心者向け推奨設定

**基本設定**
```ini
[NekoProjectII]
pc_model=VX
clk_mult=4
ExMemory=13
SNDboard=04
DispSync=1
GRCG_EGC=2
fddequip=3
usefd144=1
```

**参照マニュアル**: 各設定マニュアルの推奨設定セクション

### 3.2 高性能設定

**パフォーマンス重視**
```ini
[NekoProjectII]
pc_model=FX
clk_mult=8
ExMemory=32
fpu_type=2
asynccpu=1
SNDboard=06
SampleHz=48000
usepegcplane=1
```

**参照マニュアル**: CPU・メモリ設定マニュアル 7章、サウンド設定マニュアル 7.1章

### 3.3 互換性重視設定

**安定動作優先**
```ini
[NekoProjectII]
pc_model=VX
clk_mult=2
ExMemory=8
fpu_type=0
timerfix=1
SNDboard=04
DispSync=2
vramwait=1
```

**参照マニュアル**: CPU・メモリ設定マニュアル 7.2章、グラフィック設定マニュアル 10章

### 3.4 ゲーム用設定

**アクションゲーム**
```ini
[NekoProjectII]
clk_mult=4
SNDboard=04
DispSync=1
volume_F=64
volume_A=64
Latencys=150
```

**参照マニュアル**: サウンド設定マニュアル 7.2章、グラフィック設定マニュアル 9.1章

### 3.5 開発・作業用設定

**プログラミング環境**
```ini
[NekoProjectII]
clk_mult=8
ExMemory=16
SNDboard=04
hdrvenable=1
EMSENABLE=1
XMSENABLE=1
```

**参照マニュアル**: CPU・メモリ設定マニュアル 6.3章、ストレージ設定マニュアル 9.2章

---

## 4. 問題解決索引

### 4.1 よくある問題と解決策

#### 起動・初期化問題
| 症状 | 解決策 | 参照ページ |
|------|--------|-----------|
| エミュレータが起動しない | ランタイム確認、権限設定 | トラブルシューティング 2.1 |
| PC-98画面が表示されない | PCモデル、DIPスイッチ確認 | トラブルシューティング 2.2 |

#### 表示問題
| 症状 | 解決策 | 参照ページ |
|------|--------|-----------|
| 画面が乱れる | 表示同期、色設定確認 | トラブルシューティング 3.1 |
| フルスクリーンで問題 | フルスクリーン設定確認 | トラブルシューティング 3.2 |

#### サウンド問題
| 症状 | 解決策 | 参照ページ |
|------|--------|-----------|
| 音が出ない | 音量、サウンドボード確認 | トラブルシューティング 4.1 |
| 音飛び・ノイズ | レイテンシ、CPU負荷調整 | トラブルシューティング 4.2 |

#### ストレージ問題
| 症状 | 解決策 | 参照ページ |
|------|--------|-----------|
| ディスクが読めない | ファイルパス、形式確認 | トラブルシューティング 6.1 |
| 書き込みできない | 属性、容量確認 | ストレージ設定マニュアル 10.3 |

### 4.2 症状別診断フローチャート

```
起動問題
├── エミュレータが起動しない
│   ├── ランタイムライブラリ確認
│   ├── 権限・セキュリティ確認
│   └── 設定ファイル初期化
├── PC-98画面が出ない
│   ├── PCモデル設定確認
│   ├── DIPスイッチ確認
│   └── BIOS確認
└── 設定が保存されない
    ├── ファイル権限確認
    └── 管理者権限実行
```

---

## 5. 設定値クイックリファレンス

### 5.1 PCモデル一覧

| 値 | 機種名 | CPU | 特徴 |
|----|--------|-----|------|
| `VF` | PC-9801VF | 8086 | 基本モデル |
| `VM` | PC-9801VM | 8086 | 改良版 |
| `VX` | PC-9801VX | V30 | 推奨標準 |
| `FA` | PC-9801FA | 80286 | 高性能 |
| `FX` | PC-9801FX | 80286 | 最高性能 |

### 5.2 サウンドボード一覧

| 値 | ボード名 | 特徴 | 用途 |
|----|----------|------|------|
| `00` | なし | BEEPのみ | 最小構成 |
| `01` | PC-9801-14 | PSG 3音 | 初期ソフト |
| `02` | PC-9801-26K | FM6音+PSG3音 | 中期ソフト |
| `04` | PC-9801-86 | FM+PCM | 推奨設定 |
| `08` | PC-9801-118 | WSS互換 | Windows用 |

### 5.3 クロック倍率ガイド

| 値 | 実効速度 | 用途 | 互換性 |
|----|----------|------|--------|
| `1` | 2.5MHz | 古いソフト | 最高 |
| `2` | 5MHz | 標準動作 | 高 |
| `4` | 10MHz | 推奨設定 | 良 |
| `8` | 20MHz | 高速動作 | 中 |
| `16` | 40MHz | 最高速度 | 低 |

### 5.4 メモリサイズガイド

| 値 | 総メモリ | 用途 |
|----|----------|------|
| `0` | 640KB | 最小構成 |
| `1` | 1MB | 基本的な用途 |
| `8` | 8MB | 一般的な設定 |
| `13` | 13MB | 推奨設定 |
| `16` | 16MB | 高性能用途 |

---

## 6. 設定ファイルテンプレート

### 6.1 万能設定テンプレート

```ini
[NekoProjectII]
# 基本システム
pc_model=VX
DIPswtch=3e 73 7b
MEMswtch=48 05 04 00 01 00 00 6e

# CPU・メモリ
clk_base=2457600
clk_mult=4
ExMemory=13
fpu_type=1

# サウンド
SNDboard=04
SampleHz=44100
Latencys=150
volume_M=100

# グラフィック
DispSync=1
GRCG_EGC=2
color16b=1
realpal=1

# ストレージ
fddequip=3
usefd144=1
savefddfile=1
```

### 6.2 高性能設定テンプレート

```ini
[NekoProjectII]
# 基本システム
pc_model=FX
DIPswtch=3e 73 7b
MEMswtch=48 05 04 00 01 00 00 6e

# CPU・メモリ
clk_base=2457600
clk_mult=8
ExMemory=32
fpu_type=2
asynccpu=1

# サウンド
SNDboard=06
SampleHz=48000
Latencys=100
volume_M=90

# グラフィック
DispSync=2
GRCG_EGC=2
usepegcplane=1

# ストレージ
fddequip=3
usefd144=1
useasynchd=1
```

### 6.3 互換性重視テンプレート

```ini
[NekoProjectII]
# 基本システム
pc_model=VX
DIPswtch=3e 73 7b
MEMswtch=48 05 04 00 01 00 00 6e

# CPU・メモリ
clk_base=2457600
clk_mult=2
ExMemory=8
fpu_type=0
timerfix=1

# サウンド
SNDboard=04
SampleHz=44100
Latencys=200

# グラフィック
DispSync=2
GRCG_EGC=1
vramwait=1
tramwait=1

# ストレージ
fddequip=3
usefd144=1
```

---

## 7. FAQ・よくある質問

### 7.1 設定に関する質問

**Q: どの設定から始めればよいですか？**
A: 万能設定テンプレート（6.1章）を使用してください。多くのソフトウェアで動作します。

**Q: ゲーム用の設定はありますか？**
A: 各マニュアルの「用途別設定」章を参照してください。ゲーム種別に応じた設定を提供しています。

**Q: 設定変更後に動作しなくなりました**
A: トラブルシューティングガイド（10.1章）の緊急時対処法を参照してください。

### 7.2 互換性に関する質問

**Q: 古いソフトが動作しません**
A: クロック倍率を下げ（`clk_mult=1`または`2`）、互換性重視設定を試してください。

**Q: Windows 3.1を使用したい**
A: CPU・メモリ設定マニュアル（6.2章）のWindows 3.1用設定を参照してください。

### 7.3 パフォーマンスに関する質問

**Q: 動作が重いです**
A: トラブルシューティングガイド（7.1章）の性能問題対策を参照してください。

**Q: 最高性能を出したい**
A: 高性能設定テンプレート（6.2章）を使用し、CPU・メモリ設定マニュアルの速度重視設定を適用してください。

---

## 8. 更新履歴・バージョン情報

### 8.1 マニュアル更新履歴

- v1.0: 初版作成（ハードウェア、サウンド、グラフィック、ストレージ、CPU・メモリ設定マニュアル）
- v1.1: トラブルシューティングガイド追加
- v1.2: 設定マニュアル総合索引作成

### 8.2 対応バージョン

本マニュアルは以下のNP21WSYバージョンに対応しています:
- NP21WSY（全プラットフォーム）
- Windows版、SDL2版、X11版、macOS版

---

## 9. 関連リンク・参考資料

### 9.1 技術仕様書

- `architecture_diagram.md` - システムアーキテクチャ
- `data_structure_specification.md` - データ構造仕様
- `interface_specification.md` - インターフェース仕様

### 9.2 開発者向け資料

- `class_diagram.md` - クラス構造
- `entity_relationship_diagram.md` - データ関係図

---

このマニュアル索引を活用して、効率的にNP21WSYの設定を行ってください。
各マニュアルは相互に関連しているため、問題解決時は複数のマニュアルを参照することを推奨します。